// This file is responsible for fetching all the malware signatures for scanning.
// In my case, this is used to fetch the identity of my created own malware app
// for testing purposes. 
const express = require("express");
const router = express.Router();
const db = require("../models");
const Malware = db.malware;

router.get("/malware-signatures", async (req, res) => {
  try {
    // All the malware package names are fetched.
    const signatures = await Malware.findAll({ attributes: ["packageName"] });
    const names = signatures.map(entry => entry.packageName);
    res.status(200).json(names);
    // If the signatures are not found or couldn't be fetched, then an error
    // message is displayed. 
  } catch (error) {
    console.error("Error fetching malware signatures:", error);
    res.status(500).json({ message: "Failed to fetch malware signatures." });
  }
});
module.exports = router;